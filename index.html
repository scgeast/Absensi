<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Program Absensi Karyawan</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h3>Menu Absensi</h3>
            <button class="sidebar-toggle" id="sidebarToggle">
                <i class="fas fa-bars"></i>
            </button>
        </div>
        <ul class="sidebar-menu">
            <li>
                <a href="#" class="active" data-tab="entry">
                    <i class="fas fa-pen-to-square"></i>
                    <span>Entry Absensi</span>
                </a>
            </li>
            <li>
                <a href="#" data-tab="output">
                    <i class="fas fa-file-export"></i>
                    <span>Output Absen</span>
                </a>
            </li>
            <li>
                <a href="#" data-tab="overtime">
                    <i class="fas fa-calculator"></i>
                    <span>Perhitungan Lembur</span>
                </a>
            </li>
            <li>
                <a href="#" data-tab="absen-tabel">
                    <i class="fas fa-table"></i>
                    <span>Absen Tabel</span>
                </a>
            </li>
        </ul>
    </div>

    <!-- Header -->
    <header class="futuristic-header">
        <div class="container">
            <h1 class="header-title text-center">Sistem Absensi Karyawan</h1>
            <p class="header-subtitle text-center">Manajemen Kehadiran Modern dan Efisien</p>
        </div>
    </header>

    <!-- Main Content -->
    <div class="main-content" id="mainContent">
        <div class="container mt-4">
            <div class="filter-section">
                <div class="row">
                    <div class="col-md-4 mb-2">
                        <label for="dateRange" class="form-label">Range Tanggal</label>
                        <div class="input-group">
                            <input type="date" class="form-control" id="startDate">
                            <span class="input-group-text">s/d</span>
                            <input type="date" class="form-control" id="endDate">
                        </div>
                    </div>
                    <div class="col-md-4 mb-2">
                        <label for="employeeName" class="form-label">Nama Karyawan</label>
                        <select class="form-select" id="employeeName">
                            <option value="all">Select All</option>
                            <!-- Opsi akan diisi oleh JavaScript -->
                        </select>
                    </div>
                    <div class="col-md-4 d-flex align-items-end mb-2">
                        <button class="btn btn-futuristic me-2" id="applyFilter">
                            <i class="fas fa-filter me-1"></i> Terapkan Filter
                        </button>
                        <button class="btn btn-futuristic" id="exportExcel">
                            <i class="fas fa-file-excel me-1"></i> Export Excel
                        </button>
                    </div>
                </div>
            </div>

            <!-- Tab Content -->
            <div class="tab-content" id="absensiTabContent">
                <!-- Entry Tab -->
                <div class="tab-pane fade show active" id="entry" role="tabpanel">
                    <button type="button" class="collapsible">Form Entry Absensi</button>
                    <div class="collapsible-content">
                        <p>Masukkan kode shift (1, 2, 3, 11, 22, C, O) untuk mengisi sel dan melihat warna sesuai jenis shift.</p>

                        <div class="legend">
                            <div class="legend-item shift-1">
                                <div class="legend-color" style="background-color: #4CAF50;"></div>
                                <span>Pagi (1)</span>
                            </div>
                            <div class="legend-item shift-2">
                                <div class="legend-color" style="background-color: #FFC107;"></div>
                                <span>Siang (2)</span>
                            </div>
                            <div class="legend-item shift-3">
                                <div class="legend-color" style="background-color: #2196F3;"></div>
                                <span>Malam (3)</span>
                            </div>
                            <div class="legend-item shift-11">
                                <div class="legend-color" style="background-color: #8BC34A;"></div>
                                <span>Pjk Pagi (11)</span>
                            </div>
                            <div class="legend-item shift-22">
                                <div class="legend-color" style="background-color: #FF9800;"></div>
                                <span>Pjk Siang (22)</span>
                            </div>
                            <div class="legend-item shift-C">
                                <div class="legend-color" style="background-color: #9E9E9E;"></div>
                                <span>Cuti (C)</span>
                            </div>
                            <div class="legend-item shift-O">
                                <div class="legend-color" style="background-color: #F44336;"></div>
                                <span>Off (O)</span>
                            </div>
                        </div>

                        <div class="header-controls">
                            <div class="header-control-group">
                                <span class="header-control-label">Lebar Header:</span>
                                <input type="number" id="headerWidth" class="header-control-input" placeholder="px" min="60" max="150" value="90">
                            </div>
                            <div class="header-control-group">
                                <span class="header-control-label">Tinggi Header:</span>
                                <input type="number" id="headerHeight" class="header-control-input" placeholder="px" min="30" max="60" value="35">
                            </div>
                            <button class="btn btn-futuristic" id="applyHeaderSize">
                                <i class="fas fa-check me-1"></i> Terapkan
                            </button>
                        </div>
                    </div>

                    <div class="table-container">
                        <table id="entryTable">
                            <thead>
                                <tr>
                                    <th>Area</th>
                                    <th>Name</th>
                                    <th>Position</th>
                                    <!-- Kolom tanggal akan diisi oleh JavaScript -->
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-futuristic" id="addRow">
                            <i class="fas fa-plus me-1"></i> Add Row
                        </button>
                        <button class="btn btn-futuristic" id="saveData">
                            <i class="fas fa-save me-1"></i> Save
                        </button>
                    </div>
                </div>

                <!-- Output Tab -->
                <div class="tab-pane fade" id="output" role="tabpanel">
                    <button type="button" class="collapsible">Output Data Absensi</button>
                    <div class="collapsible-content">
                        <p>Data absensi yang telah diinput akan muncul di sini dengan shift check in/out yang sesuai.</p>
                    </div>

                    <div class="table-responsive">
                        <table id="outputTable">
                            <thead>
                                <tr>
                                    <th>Area</th>
                                    <th>Name</th>
                                    <th>Position</th>
                                    <th>Date</th>
                                    <th>Shift</th>
                                    <th>Shift Check In</th>
                                    <th>Shift Check Out</th>
                                    <th>Remarks</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Overtime Tab -->
                <div class="tab-pane fade" id="overtime" role="tabpanel">
                    <button type="button" class="collapsible">Perhitungan Lembur</button>
                    <div class="collapsible-content">
                        <p>Di sini Anda dapat mengelola perhitungan lembur karyawan.</p>
                    </div>

                    <div class="table-responsive">
                        <table class="overtime-table" id="overtimeTable">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Area</th>
                                    <th>Name</th>
                                    <th>Position</th>
                                    <th>Date</th>
                                    <th>Shift</th>
                                    <th>Shift Check In</th>
                                    <th>Shift Check Out</th>
                                    <th>WT/Normal</th>
                                    <th>Actual Check In</th>
                                    <th>Actual Check Out</th>
                                    <th>Over Time</th>
                                    <th>Cek RMC</th>
                                    <th>RKP PIC</th>
                                    <th>Rmc - Shift Check Out</th>
                                    <th>Remarks</th>
                                </tr>
                            </thead>
                            <tbody id="overtimeTableBody">
                                <!-- Data akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Absen Tabel Tab -->
                <div class="tab-pane fade" id="absen-tabel" role="tabpanel">
                    <button type="button" class="collapsible">Data Absen Tabel</button>
                    <div class="collapsible-content">
                        <p>Data absensi yang telah disimpan. Data dapat diedit tetapi tidak dapat dihapus.</p>
                    </div>

                    <div class="table-container">
                        <table id="absenTabelTable">
                            <thead>
                                <tr>
                                    <th>Area</th>
                                    <th>Name</th>
                                    <th>Position</th>
                                    <!-- Kolom tanggal akan diisi oleh JavaScript -->
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
